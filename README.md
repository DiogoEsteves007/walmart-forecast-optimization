# Walmart Sales Forecast and Optimization

This repository contains a comprehensive analysis of Walmart sales data, divided into two main phases: sales forecasting and resource optimization. The project first predicts weekly sales for four different departments and then uses these forecasts to determine the optimal allocation of staff and inventory to maximize profit and minimize operational effort.

The results are presented through an interactive R Shiny dashboard, allowing for detailed exploration of both the forecasting models and the optimization scenarios.

## Project Structure

The project is organized into three primary R scripts that handle forecasting, optimization, and visualization.

1.  **`AllModelsPredition.R`**: Manages the forecasting phase. It uses historical sales data to predict future weekly sales.
2.  **`Optimizacao.R`**: Handles the optimization phase. It takes sales forecasts as input to find the best monthly plan for staffing and inventory.
3.  **`ui.R`**: An R Shiny application that provides an interactive dashboard to visualize the results from the forecasting and optimization phases.

## Forecasting Phase

The initial phase focuses on predicting weekly sales for four Walmart departments over a four-week period.

### Dataset
The analysis is based on the `walmart.csv` dataset, which contains 143 weeks of sales data and includes the following features:
*   `Date`: The week of the sales record.
*   `Fuel_Price`: The cost of fuel in the region.
*   `IsHoliday`: A boolean indicating if the week includes a special holiday.
*   `WSdep1`, `WSdep2`, `WSdep3`, `WSdep4`: Weekly sales for each of the four departments.

### Models and Methodology
Several time-series forecasting models were evaluated:
*   **ARIMA (Autoregressive Integrated Moving Average)**
*   **Holt-Winters**
*   **MLPE (Multilayer Perceptron Ensemble)**
*   **Prophet**

The models were evaluated using two approaches:
1.  **Train-Test Split**: A standard approach where the model is trained on a portion of the data (139 weeks) and tested on the remaining data (4 weeks).
2.  **Growing Window**: A more robust evaluation where the training window size increases iteratively. This project uses 8 iterations, with the training window starting at 111 weeks and growing by 4 weeks in each step.

The ARIMA model was identified as the best-performing model. Its final predictions for a 4-week horizon are stored in `Pred_Normal/previsoes_finais_arima.csv`. The median predictions from the aformentioned 8 growing window iterations are stored in the `GrowingFinalArima/` directory.

## Optimization Phase

This phase uses the sales forecasts generated by the ARIMA model to solve a multi-objective optimization problem: maximizing monthly profit while minimizing operational effort (defined as the total number of new hires and orders placed).

### Optimization Algorithms
A variety of optimization algorithms were employed to find the best solution for resource allocation:
*   **Monte Carlo Search**
*   **Hill Climbing** (Additive and Multiplicative variants)
*   **Simulated Annealing (SANN)** (Additive and Multiplicative variants)
*   **Genetic Algorithm (GA)**
*   **Differential Evolution (DE)**
*   **NSGA-II** (for multi-objective optimization)

### Objective Function
The core of the optimization is an evaluation function that calculates profit based on a given plan for staffing and inventory. The profit is calculated as:

`Profit = Total Revenue - (Employee Costs + Order Costs + Stock Holding Costs)`

The optimization process seeks to find the combination of employee hires and weekly product orders that maximizes this value. For NSGA-II, it also seeks to minimize the total number of employees and orders.

### Results
The output of the optimization process is stored in two main directories:
*   `ResultadosOtimizacao/`: Contains the optimal solution vector (number of employees and order quantities) and the final evaluation value (profit) for each algorithm.
*   `Matrizes_efetivas/`: Provides a detailed breakdown of the complete monthly plan derived from each algorithm's best solution, including costs, revenue, and stock levels.

## Shiny Dashboard

The `ui.R` script launches an interactive dashboard to explore the project's results. The dashboard is organized into three tabs:

*   **Previsões (Forecasts)**:
    *   Displays the final 4-week sales forecast from the ARIMA model.
    *   Shows the forecasts and performance metrics (MAE, NMAE) from the 8 iterations of the growing window analysis.
    *   Includes plots comparing predicted sales against actual sales for each department and iteration.

*   **Otimização (Optimization)**:
    *   Allows users to select an optimization method and a forecast scenario (the standard 4-week forecast or one of the 8 growing window scenarios).
    *   Presents the complete optimal plan, including:
        *   Employee hiring plan by type and department.
        *   Weekly order plan by department.
        *   Breakdown of costs (employees, orders, stock).
        *   Projected sales, revenue, and final profit.

*   **Dados (Data)**:
    *   Provides a view of the original `walmart.csv` dataset.

## How to Run

### Dependencies
Ensure you have the following R libraries installed:
```R
install.packages(c("forecast", "tseries", "plotly", "ggplot2", "caret", "rminer", 
                   "gridExtra", "prophet", "zoo", "stats", "genalg", "DEoptim", 
                   "mco", "data.table", "shiny", "shinydashboard", "DT"))
```

### Execution Steps
1.  **Run Forecasting**: Execute the `AllModelsPredition.R` script. This will perform the time-series analysis and generate the necessary forecast files in `Pred_Normal/` and `GrowingFinalArima/`.
    ```R
    source("AllModelsPredition.R")
    ```
2.  **Run Optimization**: Execute the `Optimizacao.R` script. This will use the forecasts from the previous step to run all optimization algorithms and save the results in `ResultadosOtimizacao/` and `Matrizes_efetivas/`.
    ```R
    source("Optimizacao.R")
    ```
3.  **Launch Dashboard**: Run the `ui.R` script to start the Shiny application and explore the results interactively.
    ```R
    shiny::runApp("ui.R")

### Interface
<img width="2535" height="1253" alt="aaaaa" src="https://github.com/user-attachments/assets/a108ee4e-f5e2-42d2-a02f-60ea18eeb8db" />
<img width="2544" height="1275" alt="bbbbbb" src="https://github.com/user-attachments/assets/9943a3d9-e29d-4401-8677-93029d511622" />
<img width="2492" height="424" alt="ccccccccccccc" src="https://github.com/user-attachments/assets/20151e86-4de1-4107-9820-f9d0f8367a0e" />
